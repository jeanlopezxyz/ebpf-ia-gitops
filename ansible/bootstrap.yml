---
- name: Bootstrap eBPF + AI GitOps Environment
  hosts: localhost
  connection: local
  gather_facts: yes
  vars:
    minikube_profile: "ebpf-gitops"
    kubernetes_namespace: "ebpf-security"
    argocd_namespace: "argocd"
    
  tasks:
    - name: Check prerequisites
      include_role:
        name: prerequisites
      
    - name: Setup Minikube cluster
      include_role:
        name: minikube
        
    - name: Install MetalLB LoadBalancer
      include_role:
        name: metallb
      when: deployment_mode.type == 'prod'
        
    - name: Install Cilium CNI with eBPF
      include_role:
        name: cilium
        
    - name: Setup Storage Classes
      include_role:
        name: storage
        
    - name: Install Container Registry
      include_role:
        name: registry
        
    - name: Install Prometheus + Grafana Stack
      include_role:
        name: prometheus
        
    - name: Install NGINX Ingress Controller
      include_role:
        name: ingress-nginx
        
    - name: Install ArgoCD GitOps
      include_role:
        name: argocd
        
    - name: Display access information
      include_role:
        name: access-info